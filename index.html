<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>STADENS POESI</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
    }
    #googleMap {
      height: 100%;
      width: 100%;
    }

    /* Behåller din tidigare stil för InfoWindow */
    .gm-style-iw {
      width: 90%; 
      min-height: 50vh;
    }
  </style>
</head>
<body>
 <div id="googleMap"></div>
  <script>
    function initMap() {
      const map = new google.maps.Map(document.getElementById("googleMap"), {
        center: { lat: 60.6189135, lng: 16.7788006 },
        zoom: 15,
        styles: [
          { featureType: "poi.business", stylers: [{ visibility: "off" }] },
          { featureType: "road", elementType: "labels", stylers: [{ visibility: "on" }] },
          { featureType: "poi.place_of_worship", stylers: [{ visibility: "on" }] },
          { featureType: "poi.school", stylers: [{ visibility: "on" }] },
          { featureType: "poi.government", stylers: [{ visibility: "on" }] },
          { featureType: "poi.medical", stylers: [{ visibility: "on" }] },
          { featureType: "poi", elementType: "labels.text", stylers: [{ visibility: "on" }] }
        ]
      });

      const markers = [
        {
          number: 1,
          lat: 60.6223,
          lng: 16.7836,
          title: "Andakt",
          description: "Dikten Andakt, invid nordvästra murresten av Sandvikens gamla kyrka, ingår i diktsamlingen ”Har ni flaggproblem?” (1970)."
        },
        {
          number: 2,
          lat: 60.6152,
          lng: 16.7848,
          title: "I åttan, där vevaxlarna...",
          description: "Vid ånghammaren nedanför Sandviks gamla huvudkontor finns dikten I åttan, där vevaxlarna... ur ”Sotfragment” (1949)."
        },
        {
          number: 3,
          lat: 60.6160,
          lng: 16.7815,
          title: "Kärleksbrev",
          description: "Vid norra sluttningen ner mot Dal-Britas damm, sitter dikten Kärleksbrev, ur diktsamlingen ”Livets starka smak” (1974)."
        },
        {
          number: 4,
          lat: 60.6169185,
          lng: 16.7797732,
          title: "Bandvalsaren",
          description: "På gräsmattan, mitt emot entrén till Smedsgårdens museum, återfinns dikten Bandvalsaren, ur diktsamlingen ”Sotfragment” (1949)."
        },
        {
          number: 5,
          lat: 60.6150,
          lng: 16.7760,
          title: "Tvätterska",
          description: "Dikten Tvätterska, ur diktsamlingen ”Molnskugga” (1955), finns att läsa i parken nära kanalen vid Barrsätragatsbron."
        },
        {
          number: 6,
          lat: 60.6190,
          lng: 16.7740,
          title: "Himlafrukost",
          description: "Dikten Himlafrukost ur ”Livets starka smak (1974) finns på slaggstensmuren till vänster bakom restaurangen The Church."
        },
        {
          number: 7,
          lat: 60.6198,
          lng: 16.7730,
          title: "Sätt du fram ur sommarns nätta nyponskålar...",
          description: "Vid stadshuset, och Smedsgatans norra ände, finner du dikten Sätt du fram ur sommarns nätta nyponskålar..., från diktsamlingen ”Läkebok, nedresa” (1993)."
        },
        {
          number: 8,
          lat: 60.6208395,
          lng: 16.7802191,
          title: "Anteckningar om arbetet",
          description: "Anteckningar om arbetet ingår i diktsamlingen ”Livets starka smak” (1974). Den finner du på muren vid konsthallens entré."
        }
      ];

      // --- Förbättring #3: EN (återanvänd) InfoWindow ---
      const infoWindow = new google.maps.InfoWindow();

      // --- Förbättring #3: Auto-zoom till alla markörer ---
      const bounds = new google.maps.LatLngBounds();

      markers.forEach(m => {
        const marker = new google.maps.Marker({
          map,
          position: { lat: m.lat, lng: m.lng },
          label: String(m.number),
          title: m.title
        });

        // Förbättring #3: "Hitta hit" länk i InfoWindow
        const gmmLink = `https://www.google.com/maps/search/?api=1&query=${m.lat},${m.lng}`;
        const content = `
          <div style="line-height:1.4;max-width:420px">
            <strong>${m.number}. ${m.title}</strong><br/>
            ${m.description}<br/><br/>
            ${gmmLink}Hitta hit i Google Maps</a>
          </div>
        `;

        marker.addListener("click", () => {
          infoWindow.setContent(content);
          infoWindow.open(map, marker); // endast en öppen åt gången
        });

        bounds.extend(marker.getPosition());
      });

      // Auto-zoom till alla punkter
      map.fitBounds(bounds);

      // Valfri: cap max-zoom efter fitBounds (så man inte hamnar för nära)
      google.maps.event.addListenerOnce(map, "bounds_changed", () => {
        const maxZoom = 17;
        if (map.getZoom() > maxZoom) map.setZoom(maxZoom);
      });
    }

    window.onload = function() {
      const script = document.createElement('script');
      // Förbättring #3: språk/region -> svenska/Sverige
      script.src = "https://maps.googleapis.com/maps/api/js?key=&language=sv&region=SE";
      script.async = true;
      script.defer = true;
      script.onload = initMap;
      document.head.appendChild(script);
    };
  </script>
</body>
</html>
